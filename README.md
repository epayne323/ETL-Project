# ETL-Project
## Combining IMDB data from Kaggle with revenue data from Box Office Mojo

Using IMDB data, I wanted to compare movies’ ratings with their review scores. I used a set of tsv files from Kaggle, and I scraped the lifetime gross revenues from Box Office Mojo for the top 1000 highest-grossing movies from all time. I used these Kaggle data because they were readily available, and even though the gross data were not already compiled, the web page was consistently structured, making the scraping process straightforward.

To load in the Kaggle data, I first had to change the file extensions of the tsv files to csv, then use pandas read_csv function with tab separators instead of commas and export the resultant dataframes into postgres. I did this before doing any other analysis or transformations of the data because one of the files was very large at over 500mb (6,321,292 records). Although it took over 20 minutes to be loaded into postgres, it was quick to read from afterwards.  

For the web scraping portion, Box Office Mojo’s clean html made it easy to pull the titles, grosses, and revenues from their pages, using splinter to click through each of the five pages of 200 records. From there the data went into a dataframe. The gross column was stored at text because it included commas and a dollar sign. I added an additional column to convert the gross into an integer, then I loaded the dataframe into postgres.

I chose postgres because I thought there would be no need to store movie titles redundantly. However, this became an issue for one title, Beauty and the Beast, where both the original and the remake were on the highest-grossing list. I used a dual primary key (title and year) for the movie_grosses table created from scraping data. The tables from Kaggle, title_ratings and title_basics, already had unique identifiers (tconst) associated with each movie, which I assigned as their primary keys.

To actually build the table I wanted with both movie grosses and their IMDB ratings, I had to use the title_basics table as an intermediary between the movie_grosses table and the title_ratings table, because movie_grosses only had titles, grosses, and years, and title_ratings only had tconst. The first join between movie_grosses with title_basics matched on both titles and years (some movies have different primary and original title, where one may be changed for marketing purposes, and some movies have different years listed for their release dates between the two tables, I would assume because of some quibble about the date of their first appearance in any theater vs. the date of their wide release), while the second join between title_basics and title_ratings joins on tconst. Still, this query only pulled 994 of the expected 1000 records.

To get the missing six movies, I first expanded the title join to check for a discrepancy of two years between movie_grosses and title_basics. This captured *The Upside* and *Paranormal Activity*. The relevant *Everest* movie did not have a year in title_basics, and someone couldn’t decide where to put the ellipsis in *Once Upon a Time ...in Hollywood*; I added these manually. *Star Wars: Episode IX – The Rise of Skywalker* and *Jumanji: The Next Level* were not included in title_ratings because they were released after that data was last updated in November, so I left them out of the final table movie_grosses_ratings.

I believe this database would be of interest to anyone involved in making, marketing, or distributing movies, or even those who like learning about movies independent of financial considerations. The simple regression only shows a weak correlation between a movie’s average IMDB rating and its lifetime gross, but this is only for the top 1000 highest grossing movies—there’s a lot more that could be done with this analysis.